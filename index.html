<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Oleksandr Neschasnij">
<meta name="dcterms.date" content="2023-05-16">

<title>Економетрика: лабораторна робота №7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="lesson_7_files/libs/clipboard/clipboard.min.js"></script>
<script src="lesson_7_files/libs/quarto-html/quarto.js"></script>
<script src="lesson_7_files/libs/quarto-html/popper.min.js"></script>
<script src="lesson_7_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lesson_7_files/libs/quarto-html/anchor.min.js"></script>
<link href="lesson_7_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lesson_7_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lesson_7_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lesson_7_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lesson_7_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>
    .quarto-title-block .quarto-title-banner {
      background-image: url(images/banner.jpg);
background-size: cover;
    }
    </style>


</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Економетрика: лабораторна робота №7</h1>
            <p class="subtitle lead">Побудувати економетричні моделі часових рядів:статичну, динамічну(лагові незалежні змінні, авторегресійні розподілені лаги). Оцінити ефективність моделей. Запропонувати покращення специфікацій моделей. Провести інтернепреатцію отриманиї коефіцієнтів регресії</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Автор</div>
      <div class="quarto-title-meta-contents">
               <p>Oleksandr Neschasnij </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Дата публікації</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 16, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Зміст</h2>
   
  <ul class="collapse">
  <li><a href="#підготовка-датасету-та-моделі.-кластерний-аналіз" id="toc-підготовка-датасету-та-моделі.-кластерний-аналіз" class="nav-link active" data-scroll-target="#підготовка-датасету-та-моделі.-кластерний-аналіз">Підготовка датасету та моделі. Кластерний аналіз</a>
  <ul class="collapse">
  <li><a href="#обробка-даних" id="toc-обробка-даних" class="nav-link" data-scroll-target="#обробка-даних">Обробка даних</a></li>
  <li><a href="#побудова-дендрограми" id="toc-побудова-дендрограми" class="nav-link" data-scroll-target="#побудова-дендрограми">Побудова дендрограми</a></li>
  <li><a href="#результат" id="toc-результат" class="nav-link" data-scroll-target="#результат">Результат</a></li>
  </ul></li>
  <li><a href="#статична-економетрична-модель-часових-рядів" id="toc-статична-економетрична-модель-часових-рядів" class="nav-link" data-scroll-target="#статична-економетрична-модель-часових-рядів">Статична економетрична модель часових рядів</a>
  <ul class="collapse">
  <li><a href="#статична-модель-сша" id="toc-статична-модель-сша" class="nav-link" data-scroll-target="#статична-модель-сша">Статична модель США</a></li>
  <li><a href="#статична-модель-китаю" id="toc-статична-модель-китаю" class="nav-link" data-scroll-target="#статична-модель-китаю">Статична модель Китаю</a></li>
  </ul></li>
  <li><a href="#динамічна-модель" id="toc-динамічна-модель" class="nav-link" data-scroll-target="#динамічна-модель">Динамічна модель</a>
  <ul class="collapse">
  <li><a href="#модель-з-лаговими-незалежними-змінними" id="toc-модель-з-лаговими-незалежними-змінними" class="nav-link" data-scroll-target="#модель-з-лаговими-незалежними-змінними"><strong>Модель з лаговими незалежними змінними</strong></a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Автоматичний пошук оптимального числа кластерів</p>
<section id="підготовка-датасету-та-моделі.-кластерний-аналіз" class="level1">
<h1>Підготовка датасету та моделі. Кластерний аналіз</h1>
<section id="обробка-даних" class="level2">
<h2 class="anchored" data-anchor-id="обробка-даних">Обробка даних</h2>
<p>Змінюємо тип даних з <strong>dbl</strong> на <strong>date</strong> Також заповнимо пусті клітинки з NA, використовуючи функцію <strong><em><code>na.interpolation</code></em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>timePeriodModel <span class="ot">&lt;-</span> excel_file  </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>timePeriodModel[<span class="dv">4</span><span class="sc">:</span><span class="dv">14</span>] <span class="ot">&lt;-</span> <span class="fu">na_interpolation</span>(timePeriodModel[<span class="dv">4</span><span class="sc">:</span><span class="dv">14</span>], <span class="at">option =</span> <span class="st">"linear"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>timePeriodModel_fit <span class="ot">&lt;-</span> timePeriodModel <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_num =</span> year) <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"United States of America"</span>, <span class="st">"India"</span>, <span class="st">"China"</span>, <span class="st">"Spain"</span>, <span class="st">"United Kingdom"</span>), year_num <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2020</span>)) </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>timePeriodModel_scale <span class="ot">&lt;-</span>  <span class="fu">scale</span>(timePeriodModel_fit[<span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">3</span>], <span class="at">center=</span>T, <span class="at">scale=</span>T)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="побудова-дендрограми" class="level2">
<h2 class="anchored" data-anchor-id="побудова-дендрограми">Побудова дендрограми</h2>
<p><strong><em>Кластерний аналіз</em></strong> - це метод машинного навчання, що використовується для розділення групи об’єктів на підгрупи або кластери на основі схожості між ними. Запускаємо алгоритм Уорда</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>timePeriodModel_info <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(timePeriodModel_scale, <span class="at">method =</span> <span class="st">"euclidean"</span>), <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Перевірка оптимальної кількості кластерів за методами: ліктя, силуетним методом та gap_статистика</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(timePeriodModel_scale, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(timePeriodModel_scale, kmeans, <span class="at">method =</span> <span class="st">"silhouette"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(timePeriodModel_scale, kmeans, <span class="at">method =</span> <span class="st">"gap_stat"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Побудова графіку</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>vision <span class="ot">&lt;-</span> <span class="fu">cutree</span>(timePeriodModel_info, <span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(timePeriodModel_info)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(timePeriodModel_info, <span class="at">k=</span><span class="dv">4</span>, <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Реалізація K-середніх</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>kmeans.result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(timePeriodModel_scale, <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(kmeans.result, <span class="at">data=</span> timePeriodModel_scale, <span class="at">frame.type =</span> <span class="st">"convex"</span>)<span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: argument frame is deprecated; please use ellipse instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: argument frame.type is deprecated; please use ellipse.type instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="результат" class="level2">
<h2 class="anchored" data-anchor-id="результат">Результат</h2>
<p>Поелементне входження в кластери</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.tibble</span>(timePeriodModel_fit[kmeans.result<span class="sc">$</span>cluster<span class="sc">==</span><span class="dv">1</span>,])</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `as.tibble()` was deprecated in tibble 2.0.0.
ℹ Please use `as_tibble()` instead.
ℹ The signature and semantics have changed, see `?as_tibble`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 38 × 15
   stock.index country  year index.price log_indexprice inflationrate oil.prices
   &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;
 1 NASDAQ      United…  2000       3784.           3.58          0.03       28.4
 2 NASDAQ      United…  2001       2035            3.31          0.03       19.4
 3 NASDAQ      United…  2002       1540.           3.19          0.02       29.5
 4 NASDAQ      United…  2003       1647.           3.22          0.02       32.1
 5 NASDAQ      United…  2004       1987.           3.3           0.03       43.2
 6 NASDAQ      United…  2005       2099.           3.32          0.03       59.4
 7 NASDAQ      United…  2006       2263.           3.35          0.03       62.0
 8 NASDAQ      United…  2007       2578.           3.41          0.03       91.7
 9 NASDAQ      United…  2008       2162.           3.33          0.04       41.1
10 FTSE 100    United…  2000       6222.           3.79          0.01       28.4
# ℹ 28 more rows
# ℹ 8 more variables: exchange_rate &lt;dbl&gt;, gdppercent &lt;dbl&gt;,
#   percapitaincome &lt;dbl&gt;, unemploymentrate &lt;dbl&gt;, manufacturingoutput &lt;dbl&gt;,
#   tradebalance &lt;dbl&gt;, USTreasury &lt;dbl&gt;, year_num &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.tibble</span>(timePeriodModel_fit[kmeans.result<span class="sc">$</span>cluster<span class="sc">==</span><span class="dv">2</span>,])</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 15
   stock.index country  year index.price log_indexprice inflationrate oil.prices
   &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;
 1 SZCOMP      China    2005       1145.           3.06          0.02       59.4
 2 SZCOMP      China    2006       1687.           3.23          0.02       62.0
 3 SZCOMP      China    2007       4329.           3.64          0.05       91.7
 4 SZCOMP      China    2008       2913.           3.46          0.06       41.1
 5 SZCOMP      China    2009       2737.           3.44         -0.01       74.5
 6 SZCOMP      China    2010       2796.           3.45          0.03       89.2
 7 SZCOMP      China    2011       2639.           3.42          0.06       98.6
 8 SZCOMP      China    2012       2211.           3.34          0.03       87.9
 9 SZCOMP      China    2013       2183.           3.34          0.03       97.6
10 SZCOMP      China    2014       2280.           3.36          0.02       59.3
11 SZCOMP      China    2015       3657.           3.56          0.01       37.2
12 SZCOMP      China    2016       2978.           3.47          0.02       52.0
13 SZCOMP      China    2017       3257.           3.51          0.02       57.9
14 SZCOMP      China    2018       2920.           3.47          0.02       49.5
15 SZCOMP      China    2019       2929.           3.47          0.03       59.9
16 SZCOMP      China    2020       3110.           3.49          0.02       47.0
# ℹ 8 more variables: exchange_rate &lt;dbl&gt;, gdppercent &lt;dbl&gt;,
#   percapitaincome &lt;dbl&gt;, unemploymentrate &lt;dbl&gt;, manufacturingoutput &lt;dbl&gt;,
#   tradebalance &lt;dbl&gt;, USTreasury &lt;dbl&gt;, year_num &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.tibble</span>(timePeriodModel_fit[kmeans.result<span class="sc">$</span>cluster<span class="sc">==</span><span class="dv">3</span>,])</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 15
   stock.index country  year index.price log_indexprice inflationrate oil.prices
   &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;
 1 NASDAQ      United…  2009       1845.           3.27         0.03        74.5
 2 NASDAQ      United…  2010       2350.           3.37         0.02        89.2
 3 NASDAQ      United…  2011       2677.           3.43         0.03        98.6
 4 NASDAQ      United…  2012       2966.           3.47         0.02        87.9
 5 NASDAQ      United…  2013       3541.           3.55         0.01        97.6
 6 NASDAQ      United…  2014       4375.           3.64         0.02        59.3
 7 NASDAQ      United…  2015       4946.           3.69         0.015       37.2
 8 NASDAQ      United…  2016       4988.           3.7          0.01        52.0
 9 NASDAQ      United…  2017       6235.           3.79         0.02        57.9
10 NASDAQ      United…  2018       7426.           3.87         0.02        49.5
# ℹ 26 more rows
# ℹ 8 more variables: exchange_rate &lt;dbl&gt;, gdppercent &lt;dbl&gt;,
#   percapitaincome &lt;dbl&gt;, unemploymentrate &lt;dbl&gt;, manufacturingoutput &lt;dbl&gt;,
#   tradebalance &lt;dbl&gt;, USTreasury &lt;dbl&gt;, year_num &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.tibble</span>(timePeriodModel_fit[kmeans.result<span class="sc">$</span>cluster<span class="sc">==</span><span class="dv">4</span>,])</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 15
   stock.index country  year index.price log_indexprice inflationrate oil.prices
   &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;
 1 Nifty 50    India    2006      13787.           4.14          0.06       62.0
 2 Nifty 50    India    2007      20287.           4.31          0.06       91.7
 3 Nifty 50    India    2008       9647.           3.98          0.08       41.1
 4 Nifty 50    India    2009      17465.           4.24          0.11       74.5
 5 Nifty 50    India    2010      20509.           4.31          0.12       89.2
 6 Nifty 50    India    2011      15455.           4.19          0.09       98.6
 7 Nifty 50    India    2012      19427.           4.29          0.09       87.9
 8 Nifty 50    India    2013      21171.           4.33          0.11       97.6
 9 Nifty 50    India    2014      27499.           4.44          0.07       59.3
10 Nifty 50    India    2015      26118.           4.42          0.05       37.2
11 Nifty 50    India    2016      26626.           4.43          0.05       52.0
12 Nifty 50    India    2017      34057.           4.53          0.03       57.9
13 Nifty 50    India    2018      36068.           4.56          0.04       49.5
14 Nifty 50    India    2019      41254.           4.62          0.04       59.9
15 Nifty 50    India    2020      47751.           4.68          0.07       47.0
# ℹ 8 more variables: exchange_rate &lt;dbl&gt;, gdppercent &lt;dbl&gt;,
#   percapitaincome &lt;dbl&gt;, unemploymentrate &lt;dbl&gt;, manufacturingoutput &lt;dbl&gt;,
#   tradebalance &lt;dbl&gt;, USTreasury &lt;dbl&gt;, year_num &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(kmeans.result)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 4 clusters of sizes 38, 16, 36, 15

Cluster means:
  index.price log_indexprice inflationrate oil.prices exchange_rate  gdppercent
1  -0.3636429     -0.3887304    -0.1350669 -0.6906424    -0.1728289  0.09472757
2  -0.6557348     -0.9466970    -0.1336600  0.3644158    -0.2884309  1.13640036
3  -0.1544686      0.1329914    -0.5346400  0.4067970    -0.5535241 -0.78922505
4   1.9914039      1.6754144     1.7678763  0.3846044     2.0739508  0.44200323
  percapitaincome unemploymentrate manufacturingoutput tradebalance USTreasury
1      0.01182305       -0.2314494          -0.3726439  -0.26056915  1.0174471
2     -0.92207006       -0.6185524           2.0865873   1.27406932 -0.3452053
3      0.88145668        0.6640633          -0.4021231  -0.32933969 -0.7531751
4     -1.16190636       -0.3476241          -0.3165666   0.09151648 -0.4016934
    year_num
1 -1.0683158
2  0.4108907
3  0.7396033
4  0.4930688

Clustering vector:
  [1] 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3
 [38] 3 3 3 3 3 1 1 1 1 1 1 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 1 1 1 1 1 2 2 2 2 2 2
 [75] 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3

Within cluster sum of squares by cluster:
[1] 198.18599  72.12339 202.90172  92.74978
 (between_SS / total_SS =  54.7 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
</section>
</section>
<section id="статична-економетрична-модель-часових-рядів" class="level1">
<h1>Статична економетрична модель часових рядів</h1>
<section id="статична-модель-сша" class="level2">
<h2 class="anchored" data-anchor-id="статична-модель-сша">Статична модель США</h2>
<p>Перетворимо дані в часовий ряд за допомогою функції ts()</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Spain_tpm <span class="ot">&lt;-</span> timePeriodModel <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Spain"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>ts_Spain <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">14</span>, <span class="at">data =</span> Spain_tpm,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>), <span class="at">end=</span> <span class="dv">2020</span>, <span class="at">frequency=</span><span class="dv">6</span>) </span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Модель для США:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Spain_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_indexprice <span class="sc">~</span>  percapitaincome <span class="sc">+</span> manufacturingoutput<span class="sc">+</span> gdppercent, <span class="at">data =</span> ts_Spain)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Spain_lm)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_indexprice ~ percapitaincome + manufacturingoutput + 
    gdppercent, data = ts_Spain)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.19615 -0.07149 -0.01733  0.07353  0.32377 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          3.610e+00  1.801e-02 200.443  &lt; 2e-16 ***
percapitaincome      2.209e-05  6.106e-07  36.175  &lt; 2e-16 ***
manufacturingoutput -1.591e-03  1.316e-04 -12.088  &lt; 2e-16 ***
gdppercent           1.385e+00  2.585e-01   5.358 1.99e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1091 on 237 degrees of freedom
Multiple R-squared:  0.8525,    Adjusted R-squared:  0.8506 
F-statistic: 456.5 on 3 and 237 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(<span class="fu">qt</span>(<span class="fl">0.1</span>, <span class="dv">236</span>))</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.285149</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(Spain_lm)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            2.5 %        97.5 %
(Intercept)          3.574266e+00  3.645222e+00
percapitaincome      2.088556e-05  2.329135e-05
manufacturingoutput -1.850506e-03 -1.331873e-03
gdppercent           8.760274e-01  1.894685e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(Spain_lm<span class="sc">$</span>residuals, <span class="at">type =</span> <span class="st">"correlation"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(Spain_lm)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  Spain_lm
DW = 0.75282, p-value &lt; 2.2e-16
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>Інтерпритація таких графіків доволі проста. На даному графіку спостерігається значення автокорильованих залишків, що взаємодіють між собою. Вісь х відповідає різним лагам, тобто числу псріодів, за якими розраховується коефіцієнт автокореляції, а вісь у показує кореляцію для кожного з відставань. Пунктирна блакитна лінія покаїзує рівень значущості.</p>
<p>Перша вертикальна лінія, де лаг— 0, показує кореляцію залишків із самим собою, тому завжди 100%-ва.При відсутності автокореляції наступні вертикальні смуги будуть швидко спадати</p>
<p>Також перевірити наявність цього явища можна за допомогою тесту Д-В</p>
<p><strong><em>Тест Дарбіна-Вотсона</em></strong> - це статистичний тест на автокореляцію ряду залишків після регресійного аналізу. Він дозволяє виявити наявність автокореляції першого порядку в залишках регресійної моделі.</p>
<p>Як бачимо з результатів тесту у моделі присутня позитивна автокореляція</p>
<p>Створення часового ряду для візуалізації окремих показників: індекс ціни, ціну на нафту та виручку виробництв</p>
<p>Візуалізуємо деякі часові ряди</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ts_Spain_logindex <span class="ot">&lt;-</span> <span class="fu">ts</span>(Spain_tpm<span class="sc">$</span>log_indexprice, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="dv">2020</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>Spain_plot_1 <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(ts_Spain_logindex, <span class="at">xlab =</span> <span class="st">"Рік"</span>, <span class="at">ylab =</span> <span class="st">"Індекс ціни в Іспанії"</span>) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>ts_Spain_index <span class="ot">&lt;-</span> <span class="fu">ts</span>(Spain_tpm<span class="sc">$</span>index.price, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="dv">2020</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>Spain_plot_2 <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(ts_Spain_index, <span class="at">xlab =</span> <span class="st">"Рік"</span>, <span class="at">ylab =</span> <span class="st">"Логарифм індексу цін в Іспанії "</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(Spain_plot_1, Spain_plot_2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ts_Spain_oil <span class="ot">&lt;-</span> <span class="fu">ts</span>(Spain_tpm<span class="sc">$</span>gdppercent, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="dv">2020</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_Spain_oil, <span class="at">xlab =</span> <span class="st">"Рік"</span>, <span class="at">ylab =</span> <span class="st">"ВВП в Іспанії"</span>) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ts_Spain_manuf <span class="ot">&lt;-</span> <span class="fu">ts</span>(Spain_tpm<span class="sc">$</span>manufacturingoutput, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="dv">2020</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_Spain_manuf, <span class="at">xlab =</span> <span class="st">"Рік"</span>, <span class="at">ylab =</span> <span class="st">"Виручкка виробництв Іспанії"</span>) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"cyan"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="статична-модель-китаю" class="level2">
<h2 class="anchored" data-anchor-id="статична-модель-китаю">Статична модель Китаю</h2>
<p>Перетворимо дані в часовий ряд за допомогою функції <strong><code>ts()</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>China_tpm <span class="ot">&lt;-</span> timePeriodModel <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"China"</span>) </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>ts_China <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">14</span>, <span class="at">data =</span> China_tpm,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>), <span class="at">end=</span> <span class="dv">2020</span>, <span class="at">frequency=</span><span class="dv">6</span>) </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>China_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_indexprice <span class="sc">~</span> inflationrate <span class="sc">+</span> oil.prices  <span class="sc">+</span> tradebalance, <span class="at">data =</span> ts_China)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(China_lm)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_indexprice ~ inflationrate + oil.prices + tradebalance, 
    data = ts_China)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.219343 -0.035731 -0.006369  0.028950  0.220891 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    3.083e+00  1.235e-02 249.634  &lt; 2e-16 ***
inflationrate -2.256e-01  9.800e-02  -2.302  0.02221 *  
oil.prices     9.611e-04  3.007e-04   3.196  0.00158 ** 
tradebalance   1.157e-03  6.533e-05  17.706  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.08005 on 237 degrees of freedom
Multiple R-squared:  0.8041,    Adjusted R-squared:  0.8016 
F-statistic: 324.3 on 3 and 237 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(<span class="fu">qt</span>(<span class="fl">0.1</span>, <span class="dv">235</span>))</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.285164</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(China_lm)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      2.5 %       97.5 %
(Intercept)    3.0582670943  3.106920576
inflationrate -0.4186474587 -0.032518612
oil.prices     0.0003687789  0.001553509
tradebalance   0.0010279983  0.001285395</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(China_lm<span class="sc">$</span>residuals, <span class="at">type =</span> <span class="st">"correlation"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(China_lm)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  China_lm
DW = 1.1614, p-value = 1.531e-11
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>Візуалізуємо деякі часові ряди</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ts_China_logindex <span class="ot">&lt;-</span> <span class="fu">ts</span>(China_tpm<span class="sc">$</span>log_indexprice, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="dv">2020</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>China_plot_1 <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(ts_China_logindex, <span class="at">xlab =</span> <span class="st">"Рік"</span>, <span class="at">ylab =</span> <span class="st">"Індекс ціни в Китаї"</span>) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>ts_China_index <span class="ot">&lt;-</span> <span class="fu">ts</span>(China_tpm<span class="sc">$</span>index.price, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="dv">2020</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>China_plot_2 <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(ts_China_index, <span class="at">xlab =</span> <span class="st">"Рік"</span>, <span class="at">ylab =</span> <span class="st">"Логарифм індексу цін в Китаї "</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(China_plot_1, China_plot_2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>ts_China_oil <span class="ot">&lt;-</span> <span class="fu">ts</span>(China_tpm<span class="sc">$</span>oil.prices, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="dv">2020</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_China_oil, <span class="at">xlab =</span> <span class="st">"Рік"</span>, <span class="at">ylab =</span> <span class="st">"Ціни на паливо в Китаї"</span>) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ts_China_trade <span class="ot">&lt;-</span> <span class="fu">ts</span>(China_tpm<span class="sc">$</span>tradebalance, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="dv">2020</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_China_trade, <span class="at">xlab =</span> <span class="st">"Рік"</span>, <span class="at">ylab =</span> <span class="st">"Баланс торгівлі в Китаї"</span>) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"cyan"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="динамічна-модель" class="level1">
<h1>Динамічна модель</h1>
<p><strong><em>Динамічна модель</em></strong> є математичною моделлю, яка використовується для аналізу процесів, що змінюються в часі. Наприклад, часовий ряд, який відображає зміни якоїсь змінної відносно часу. У динамічній моделі вони описуються не тільки за допомогою попередніх значень, але й за допомогою змінних, які залежать від змінних попередніх періодів. Вони називаються <strong><em>лаговими змінними</em></strong>, а їх кількість - <strong><em>лагами</em></strong>. Таким чином, динамічна модель дозволяє врахувати залежність між змінними в часі, що дозволяє більш точно описати реальні процеси.</p>
<section id="модель-з-лаговими-незалежними-змінними" class="level2">
<h2 class="anchored" data-anchor-id="модель-з-лаговими-незалежними-змінними"><strong>Модель з лаговими незалежними змінними</strong></h2>
<p>Створюємо модель, використовуючи у ній&nbsp;<strong><code>lag()</code></strong>, функцію для створення лагових змінних з кількістю лагів, вказаних у параметрі&nbsp;<strong><code>k</code></strong></p>
<section id="модель-іспанії" class="level3">
<h3 class="anchored" data-anchor-id="модель-іспанії">Модель Іспанії</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>Spain_lm_lag <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_indexprice <span class="sc">~</span> inflationrate <span class="sc">+</span> <span class="fu">lag</span>(inflationrate, <span class="dv">1</span>)  <span class="sc">+</span> <span class="fu">lag</span>(oil.prices, <span class="dv">1</span>) <span class="sc">+</span> percapitaincome, <span class="at">data =</span> ts_Spain)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Spain_lm_lag)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_indexprice ~ inflationrate + lag(inflationrate, 
    1) + lag(oil.prices, 1) + percapitaincome, data = ts_Spain)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.19085 -0.08025 -0.02538  0.07761  0.33668 

Coefficients: (1 not defined because of singularities)
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            3.712e+00  2.217e-02 167.421   &lt;2e-16 ***
inflationrate         -2.652e+00  2.617e-01 -10.130   &lt;2e-16 ***
lag(inflationrate, 1)         NA         NA      NA       NA    
lag(oil.prices, 1)    -5.792e-04  5.537e-04  -1.046    0.297    
percapitaincome        1.342e-05  1.224e-06  10.960   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1192 on 237 degrees of freedom
Multiple R-squared:  0.8239,    Adjusted R-squared:  0.8216 
F-statistic: 369.5 on 3 and 237 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(Spain_lm_lag<span class="sc">$</span>residuals, <span class="at">type =</span> <span class="st">"correlation"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(Spain_lm_lag)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  Spain_lm_lag
DW = 0.65242, p-value = 0.7616
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>Зменшення автокореляції за допомогою моделі AR</p>
<pre><code></code></pre>
</section>
<section id="модель-китаю" class="level3">
<h3 class="anchored" data-anchor-id="модель-китаю">Модель Китаю</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>China_lm_lag <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_indexprice <span class="sc">~</span>   <span class="fu">lag</span>(inflationrate, <span class="dv">1</span>)  <span class="sc">+</span> <span class="fu">lag</span>(oil.prices, <span class="dv">1</span>) <span class="sc">+</span> oil.prices <span class="sc">+</span> tradebalance  <span class="sc">+</span> <span class="fu">lag</span>(tradebalance,<span class="dv">2</span>), <span class="at">data =</span> ts_China)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(China_lm_lag)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_indexprice ~ lag(inflationrate, 1) + lag(oil.prices, 
    1) + oil.prices + tradebalance + lag(tradebalance, 2), data = ts_China)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.219343 -0.035731 -0.006369  0.028950  0.220891 

Coefficients: (2 not defined because of singularities)
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            3.083e+00  1.235e-02 249.634  &lt; 2e-16 ***
lag(inflationrate, 1) -2.256e-01  9.800e-02  -2.302  0.02221 *  
lag(oil.prices, 1)     9.611e-04  3.007e-04   3.196  0.00158 ** 
oil.prices                    NA         NA      NA       NA    
tradebalance           1.157e-03  6.533e-05  17.706  &lt; 2e-16 ***
lag(tradebalance, 2)          NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.08005 on 237 degrees of freedom
Multiple R-squared:  0.8041,    Adjusted R-squared:  0.8016 
F-statistic: 324.3 on 3 and 237 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(China_lm_lag<span class="sc">$</span>residuals, <span class="at">type =</span> <span class="st">"correlation"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lesson_7_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(China_lm_lag)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  China_lm_lag
DW = 1.1614, p-value = 0.7617
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопійовано!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопійовано!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>